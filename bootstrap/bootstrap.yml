- hosts: localhost
  connection: local
  tasks:
  - name: Install debs
    apt:
      pkg: "{{ item }}"
      state: present
      update_cache: yes
    with_items:
      - avahi-utils
      - build-essential
      - emacs
      - firefox
      - gnupg-agent
      - i3
      - lightdm-gtk-greeter
      - lxc
      - markdown
      - pass
      - pidgin
      - python-dev
      - ssh-askpass
      - texlive
      - tetex-brev
      - unison
      - x11-xserver-utils
      - xfonts-terminus
      - zsh
    sudo: yes

  - name: Install user python
    pip:
      name: "{{ item }}"
      extra_args: --user --upgrade
    with_items:
      - flake8
      - git-up

  # Stow
  - name: Fetch stow
    get_url:
      url: https://ftp.gnu.org/gnu/stow/stow-2.2.2.tar.gz
      dest: /tmp/
  - name: Unpack stow
    command: tar xf stow-2.2.2.tar.gz
    args:
      chdir: /tmp
  - name: Configure stow
    command: ./configure
    args:
      chdir: /tmp/stow-2.2.2
  - name: Make stow
    command: make
    args:
      chdir: /tmp/stow-2.2.2
  - name: Install stow
    command: make install
    args:
      chdir: /tmp/stow-2.2.2
    sudo: yes
